<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/x-icon" href="assets/tennis-report/favicon-32thin.ico">
  <link rel="shortcut icon" href="assets/tennis-report/favicon-32thin.ico">
  <link rel="icon" type="image/png" sizes="128x128" href="assets/tennis-report/favicon-128.png">
  <meta property="og:type" content="website">
  <meta property="og:title" content="L4 Closed - U12 Girls Singles">
  <meta property="og:image" content="https://jazzyalex.github.io/TennisGroup/assets/tennis-report/og-image-edge-1200x630.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Tournament report preview">
  <meta property="og:image" content="https://jazzyalex.github.io/TennisGroup/assets/tennis-report/og-image-edge.svg">
  <meta property="og:image:type" content="image/svg+xml">
  <meta property="og:image:alt" content="Tournament report preview">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://jazzyalex.github.io/TennisGroup/assets/tennis-report/og-image-edge-1200x630.png">
  <meta name="twitter:image:alt" content="Tournament report preview">
  <title>Tournament Preparation Report</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      padding-top: 24px;
      background-color: #f5f5f5;
      border-top: 4px solid #4472C4;
    }

    .report-header {
      max-width: 1000px;
      margin: 12px auto 24px;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 74px;
    }

    .report-header-logo {
      width: 108px;
      height: 108px;
      display: block;
      object-fit: contain;
      flex-shrink: 0;
    }

    .report-header-text {
      text-align: center;
    }

    h1 {
      color: #2c3e50;
      text-align: center;
      margin: 0;
      font-size: 2.2em;
      font-weight: bold;
    }

    .tournament-dates {
      text-align: center;
      color: #2c3e50;
      font-size: 1.3em;
      font-weight: 600;
      margin: 8px 0 12px;
    }

    .tournament-info {
      text-align: center;
      color: #7f8c8d;
      margin: 0 0 10px;
      font-size: 14px;
      line-height: 1.6;
    }

    .tournament-info a {
      color: inherit;
      text-decoration: underline;
    }

    .table-meta {
      max-width: 1000px;
      margin: 10px auto 6px;
      width: 100%;
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 12px;
    }

    .key-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: flex-start;
      font-size: 12px;
      color: #2c3e50;
    }

    .key-stat {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 0;
      background: none;
      border: none;
      border-radius: 0;
    }

    .key-stat .key-value {
      font-weight: 700;
      color: #1f3b68;
    }

    .key-stat:not(:last-child)::after {
      content: "•";
      margin-left: 8px;
      color: #9aa9c0;
    }

    .link-legend {
      text-align: right;
      font-size: 11px;
      color: #666;
      white-space: nowrap;
    }

    .selection-callout {
      margin: 8px 0 12px;
      padding: 8px 10px;
      font-size: 12px;
      color: #2c3e50;
      background-color: #f3f6fb;
      border-left: 3px solid #4472C4;
      border-radius: 4px;
    }

    table {
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    th {
      background-color: #4472C4;
      color: white;
      padding: 12px 10px;
      text-align: left;
      font-weight: bold;
      font-size: 13px;
      border-right: 1px solid white;
    }

    th:last-child {
      border-right: none;
    }

    /* Sortable column indicator */
    th.sortable {
      cursor: pointer;
    }

    th.sortable::after {
      content: ' ↕';
      font-size: 0.7em;
      opacity: 0.6;
      margin-left: 5px;
    }

    th.sortable[data-sort="asc"]::after {
      content: ' ↑';
      opacity: 0.9;
    }

    th.sortable[data-sort="desc"]::after {
      content: ' ↓';
      opacity: 0.9;
    }

    td {
      padding: 8px 10px;
      font-size: 13px;
      border-bottom: 1px solid #ddd;
    }

    /* Alternating row colors - exactly like the sample */
    tbody tr:nth-child(odd) {
      background-color: white;
    }

    tbody tr:nth-child(even) {
      background-color: #D9E2F3;
    }

    /* Hover effect */
    tbody tr:hover {
      background-color: #EAF2FB !important;
      cursor: pointer;
    }

    /* Highlighted player (Alexis) */
    tr.highlight-player {
      background-color: white !important;
    }

    tr.highlight-player:hover {
      background-color: white !important;
    }

    tr.highlight-player td {
      color: #222;
      font-weight: 600;
    }

    tr.highlight-player td.col-wtn {
      font-weight: normal;
    }

    tr.highlight-player td:nth-child(1) {
      border-left: 4px solid #f5c542;
    }

    tr.highlight-player td:nth-child(2) {
      background-color: #fff3cd;
    }

    tr.highlight-player td:nth-child(3) {
      background-color: #fff3cd;
    }

    tr.highlight-player:hover td:nth-child(2) {
      background-color: #fff3cd;
    }

    tr.highlight-player:hover td:nth-child(3) {
      background-color: #fff3cd;
    }

    /* Column alignment */
    .col-rank {
      text-align: center;
      width: 50px;
      font-weight: 600;
      color: #666;
    }

    .col-wtn {
      text-align: right;
      font-weight: normal;
    }

    .col-utr, .col-national {
      text-align: right;
      font-weight: 600;
    }

    .col-wtn, .col-utr {
      width: 70px;
    }

    .col-national {
      width: 85px;
    }

    tbody td:nth-child(3) {
      text-transform: capitalize;
    }

    td.col-wtn, td.col-utr, td.col-national {
      box-shadow: inset 0 0 0 9999px rgba(68, 114, 196, 0.06);
    }

    /* Links inside metric cells (keep visual style) */
    td.col-wtn a, td.col-utr a, td.col-national a {
      color: inherit;
      text-decoration: none;
      display: inline-block;
      width: 100%;
    }

    td.col-wtn a:hover, td.col-utr a:hover, td.col-national a:hover {
      text-decoration: underline;
    }

    /* Statistics section */
    .stats-section {
      max-width: 1000px;
      margin: 30px auto;
      padding: 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .stats-section h3 {
      color: #2c3e50;
      margin-top: 0;
      border-bottom: 2px solid #4472C4;
      padding-bottom: 10px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin-top: 15px;
    }

    .stat-box {
      padding: 15px;
      background-color: #f8f9fa;
      border-left: 4px solid #4472C4;
      border-radius: 4px;
    }

    .stat-label {
      font-size: 11px;
      color: #666;
      text-transform: uppercase;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 20px;
      font-weight: bold;
      color: #2c3e50;
    }

    .utr-histogram {
      max-width: 1000px;
      margin: 20px auto;
      padding: 16px 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
    }

    .utr-histogram h3 {
      color: #2c3e50;
      margin-top: 0;
      border-bottom: 2px solid #4472C4;
      padding-bottom: 8px;
    }

    .utr-subtitle {
      font-weight: normal;
      font-size: 12px;
      color: #5a6b7d;
    }

    .utr-histogram-chart {
      margin-top: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .utr-bin {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 11px;
      color: #2c3e50;
    }

    .utr-bin-label {
      width: 90px;
      text-align: right;
      color: #5a6b7d;
    }

    .utr-bin-bar-wrap {
      flex: 1;
      height: 12px;
      background-color: #eef2f8;
      border-radius: 999px;
      overflow: hidden;
    }

    .utr-bin-bar {
      height: 100%;
      background-color: #4472C4;
      border-radius: 999px;
    }

    .utr-bin.is-highlight .utr-bin-bar {
      background-color: #f5c542;
    }

    .utr-bin-count {
      width: 28px;
      text-align: right;
      font-weight: 600;
      color: #2c3e50;
    }

    .utr-histogram-caption {
      font-size: 11px;
      color: #666;
      margin-top: 12px;
      padding-bottom: 4px;
      text-align: center;
    }

    /* Tournament Details Page */
    .tournament-details-page {
      max-width: 1000px;
      margin: 30px auto;
      padding: 30px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      page-break-before: always;
    }

    .tournament-details-page h2 {
      color: #2c3e50;
      border-bottom: 3px solid #4472C4;
      padding-bottom: 10px;
      margin-top: 0;
    }

    .tournament-details-page h3 {
      color: #4472C4;
      margin-top: 25px;
      margin-bottom: 10px;
    }

    .detail-row {
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }

    .detail-label {
      font-weight: bold;
      color: #555;
      display: inline-block;
      width: 180px;
    }

    .detail-value {
      color: #2c3e50;
    }

    .important-note {
      background-color: #fff9e6;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin-top: 20px;
      border-radius: 4px;
    }

    /* Share button */
    .share-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #4472C4;
      color: white;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
    }

    .share-button:hover {
      background-color: #2c5aa0;
      transform: scale(1.05);
    }

    .share-button:active {
      transform: scale(0.95);
    }

    /* Sticky header */
    .sticky-header {
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 1px 6px rgba(0,0,0,0.12);
    }

    /* Click-to-call phone link */
    a[href^="tel"] {
      color: #4472C4;
      text-decoration: none;
      font-weight: 600;
    }

    a[href^="tel"]:hover {
      text-decoration: underline;
    }

    /* Dark Mode Support */
    @media (prefers-color-scheme: dark) {
      body {
        background-color: #1a1a1a;
        color: #e0e0e0;
      }

      h1 {
        color: #ffffff;
      }

      .report-header-logo {
        filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.35));
      }

      .tournament-dates {
        color: #ffffff;
      }

      .tournament-info {
        color: #b0b0b0;
      }

      table {
        background-color: #2a2a2a;
        color: #e0e0e0;
      }

      th {
        background-color: #3a5a8a;
      }

      tbody tr:nth-child(odd) {
        background-color: #2a2a2a;
      }

      tbody tr:nth-child(even) {
        background-color: #333333;
      }

      tbody tr:hover {
        background-color: #404040 !important;
      }

      tr.highlight-player {
        background-color: #2a2a2a !important;
      }

      tr.highlight-player:hover {
        background-color: #2a2a2a !important;
      }

      tr.highlight-player td {
        color: #ffd700;
      }

      tr.highlight-player td:nth-child(2) {
        background-color: #3b2f1a;
      }

      tr.highlight-player td:nth-child(3) {
        background-color: #3b2f1a;
      }

      tr.highlight-player td:nth-child(1) {
        border-left-color: #d4a700;
      }

      td {
        border-bottom: 1px solid #404040;
      }

      .stats-section, .tournament-details-page, .utr-histogram {
        background-color: #2a2a2a;
        color: #e0e0e0;
      }

      .stats-section h3, .tournament-details-page h2, .tournament-details-page h3, .utr-histogram h3 {
        color: #ffffff;
        border-bottom-color: #3a5a8a;
      }

      .stat-box {
        background-color: #333333;
        border-left-color: #3a5a8a;
      }

      .stat-value, .stat-label {
        color: #e0e0e0;
      }

      .utr-subtitle {
        color: #9aa9c0;
      }

      .utr-bin {
        color: #e0e0e0;
      }

      .utr-bin-label {
        color: #9aa9c0;
      }

      .utr-bin-bar-wrap {
        background-color: #2f3644;
      }

      .utr-bin-bar {
        background-color: #6b9bd1;
      }

      .utr-bin.is-highlight .utr-bin-bar {
        background-color: #f5c542;
      }

      .utr-bin-count {
        color: #e0e0e0;
      }

      .utr-histogram-caption {
        color: #b0b0b0;
      }

      .detail-row {
        border-bottom: 1px solid #404040;
      }

      .detail-label {
        color: #b0b0b0;
      }

      .detail-value {
        color: #e0e0e0;
      }

      .key-stat {
        color: #e0e0e0;
        background-color: transparent;
        border: none;
      }

      .key-stat .key-value {
        color: #cfe0ff;
      }

      td.col-wtn, td.col-utr, td.col-national {
        box-shadow: inset 0 0 0 9999px rgba(120, 160, 220, 0.08);
      }

      .selection-callout {
        color: #e0e0e0;
        background-color: #2f3644;
        border-left-color: #6b9bd1;
      }

      .important-note {
        background-color: #3a3a1a;
        border-left-color: #d4a700;
        color: #e0e0e0;
      }

      a {
        color: #6b9bd1;
      }

      a:hover {
        color: #8bb3e0;
      }

      .share-button {
        background-color: #3a5a8a;
      }

      .share-button:hover {
        background-color: #4a6a9a;
      }
    }

    /* Mobile/Tablet Responsive Styles */
    @media screen and (max-width: 768px) {
      body {
        margin: 10px;
      }

      .report-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        margin: 8px auto 10px;
      }

      .report-header-logo {
        width: 96px;
        height: 96px;
        position: static;
        transform: none;
      }

      h1 {
        font-size: 1.8em;
      }

      .tournament-info {
        font-size: 12px;
        margin-bottom: 15px;
      }

      .table-meta {
        flex-direction: column;
        align-items: flex-start;
      }

      .link-legend {
        align-self: stretch;
        text-align: left;
      }

      /* Table container for horizontal scrolling */
      table {
        display: block;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        font-size: 12px;
      }

      thead, tbody {
        display: table;
        width: 100%;
      }

      /* Larger tap targets for sortable headers */
      th.sortable {
        padding: 15px 8px;
        cursor: pointer;
        -webkit-tap-highlight-color: rgba(68, 114, 196, 0.3);
      }

      th, td {
        padding: 10px 6px;
      }

      /* Make row numbers and ratings more prominent */
      .col-rank {
        font-size: 13px;
        font-weight: bold;
      }

      .col-wtn, .col-utr {
        font-size: 13px;
      }

      /* Hide Location column on very small screens (under 480px) */
      @media screen and (max-width: 480px) {
        th:last-child,
        td:last-child {
          display: none;
        }
      }

      /* Stats section - stack on mobile */
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }

      .utr-histogram {
        padding: 15px;
        margin: 20px 0;
      }

      .utr-bin-label {
        width: 70px;
        font-size: 10px;
      }

      .utr-bin-count {
        width: 24px;
        font-size: 10px;
      }

      .stat-box {
        padding: 12px;
      }

      .stat-label {
        font-size: 10px;
      }

      .stat-value {
        font-size: 16px;
      }

      /* Tournament details - better mobile layout */
      .tournament-details-page {
        padding: 15px;
        margin: 15px 0;
      }

      .tournament-details-page h2 {
        font-size: 1.5em;
      }

      .tournament-details-page h3 {
        font-size: 1.2em;
        margin-top: 20px;
      }

      .detail-row {
        padding: 8px 0;
        font-size: 13px;
      }

      .detail-label {
        display: block;
        width: 100%;
        margin-bottom: 3px;
        font-size: 11px;
      }

      .detail-value {
        display: block;
        padding-left: 0;
      }

      /* Touch-friendly links */
      .detail-value a {
        display: inline-block;
        padding: 8px 0;
        line-height: 1.4;
        -webkit-tap-highlight-color: rgba(68, 114, 196, 0.2);
      }

      .important-note {
        padding: 12px;
        font-size: 13px;
      }

      /* Show share button on mobile */
      .share-button {
        display: flex;
      }
    }

    /* Print styles */
    @media print {
      /* Page setup */
      @page {
        size: letter;
        margin: 0.5in;
      }

      body {
        background-color: white;
        margin: 0;
        padding: 0;
      }

      /* Hide share button in print */
      .share-button {
        display: none !important;
      }

      /* Remove shadows and unnecessary decorations */
      table, .stats-section, .tournament-details-page, .utr-histogram {
        box-shadow: none;
        border: 1px solid #ddd;
      }

      /* Table optimizations */
      table {
        font-size: 10pt;
        page-break-inside: auto;
      }

      thead {
        display: table-header-group;
      }

      tr {
        page-break-inside: avoid;
        page-break-after: auto;
      }

      tbody tr:hover {
        background-color: inherit !important;
      }

      /* Keep alternating row colors for readability */
      tbody tr:nth-child(odd) {
        background-color: white !important;
      }

      tbody tr:nth-child(even) {
        background-color: #f0f0f0 !important;
      }

      /* Highlight Alexis in print */
      tr.highlight-player td {
        color: #000 !important;
        font-weight: bold !important;
        background-color: #ffffcc !important;
      }

      tr.highlight-player td.col-wtn {
        font-weight: normal !important;
      }

      /* Column widths for print */
      .col-rank {
        width: 30px;
      }

      th, td {
        padding: 6px 8px;
      }

      /* Stats section */
      .stats-section {
        page-break-before: auto;
        page-break-after: auto;
        page-break-inside: avoid;
        margin: 20px 0;
        padding: 15px;
      }

      .utr-histogram {
        page-break-inside: avoid;
        margin: 20px 0;
        padding: 15px;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
      }

      .stat-box {
        background-color: #f8f9fa !important;
        border: 1px solid #ddd;
      }

      /* Tournament details page */
      .tournament-details-page {
        page-break-before: always;
        margin: 0;
        padding: 20px;
      }

      .tournament-info {
        font-size: 11pt;
        margin-bottom: 20px;
      }

      h1 {
        font-size: 18pt;
        margin-bottom: 5px;
      }

      h2 {
        font-size: 16pt;
        margin-top: 15px;
      }

      h3 {
        font-size: 13pt;
        margin-top: 15px;
        margin-bottom: 8px;
      }

      /* Make links visible in print */
      a {
        color: #000;
        text-decoration: underline;
      }

      /* Important note styling */
      .important-note {
        background-color: #f9f9f9 !important;
        border: 2px solid #666;
        padding: 12px;
        margin-top: 15px;
      }

      .detail-row {
        padding: 6px 0;
        font-size: 11pt;
      }
    }
  </style>
</head>
<body>
  <div class="report-header">
    <img class="report-header-logo" src="assets/tennis-report/favicon-256.png" alt="Tennis report logo">
    <div class="report-header-text">
      <h1>L4 Closed - U12 Girls Singles</h1>
      <div class="tournament-dates">
        January 10-18, 2026
      </div>
      <div class="tournament-info">
        <a href="https://playtennis.usta.com/Competitions/fourdirectionstennis/Tournaments/Overview/EAD0497A-559C-4765-9253-2BF848B4FC4A" target="_blank" rel="noopener noreferrer" title="Open tournament page">Level 4 Closed - FDT Level 4 Junior 12s & 14s Singles Excellence</a><br>
        Willow Glen MS/HS & Piedmont Hills HS, San Jose, CA • 39 Players
      </div>
    </div>
  </div>
  <div class="table-meta">
    <div class="key-stats">
      <div class="key-stat"><span class="key-label">Draw</span><span class="key-value">32</span></div>
      <div class="key-stat"><span class="key-label">Alexis Seed</span><span class="key-value">20 / 39</span></div>
      <div class="key-stat"><span class="key-label">% Above Alexis (UTR)</span><span class="key-value">31%</span></div>
    </div>
    <div class="link-legend">Click on WTN for USTA profile • on UTR for UTR profile</div>
  </div>

  <table>
    <thead class="sticky-header">
      <tr>
        <th class="col-rank">#</th>
        <th class="sortable">First Name</th>
        <th class="sortable">Last Name</th>
        <th class="col-wtn sortable">WTN</th>
        <th class="col-utr sortable">UTR</th>
        <th class="col-national sortable">Nat Rank</th>
        <th class="sortable">Location</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="col-rank">1</td>
        <td>Ziva</td>
        <td>GADGIL</td>
        
        <td class="col-wtn">30.63</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3415960" target="_blank" rel="noopener noreferrer">5.95</a></td>
        <td class="col-national">124</td>
        <td>San Mateo CA</td>
      </tr>
      <tr>
        <td class="col-rank">2</td>
        <td>Alexi</td>
        <td>LABRECQUE</td>
        
        <td class="col-wtn">31.76</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3575442" target="_blank" rel="noopener noreferrer">5.6</a></td>
        <td class="col-national">253</td>
        <td>Mountain View CA</td>
      </tr>
      <tr>
        <td class="col-rank">3</td>
        <td>Harper</td>
        <td>WANG</td>
        
        <td class="col-wtn">32.06</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/2774013" target="_blank" rel="noopener noreferrer">5.53</a></td>
        <td class="col-national">120</td>
        <td>San Jose CA</td>
      </tr>
      <tr>
        <td class="col-rank">4</td>
        <td>Margaret</td>
        <td>DORAN</td>
        
        <td class="col-wtn">32.11</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/5583125" target="_blank" rel="noopener noreferrer">4.63</a></td>
        <td class="col-national">771</td>
        <td>Atherton CA</td>
      </tr>
      <tr>
        <td class="col-rank">5</td>
        <td>Zhiyan</td>
        <td>DUAN</td>
        
        <td class="col-wtn">32.27</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4313318" target="_blank" rel="noopener noreferrer">5.09</a></td>
        <td class="col-national">259</td>
        <td>San Jose CA</td>
      </tr>
      <tr>
        <td class="col-rank">6</td>
        <td>Camille</td>
        <td>KUNKEL</td>
        
        <td class="col-wtn">32.88</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3338600" target="_blank" rel="noopener noreferrer">5.09</a></td>
        <td class="col-national">312</td>
        <td>Fremont CA</td>
      </tr>
      <tr>
        <td class="col-rank">7</td>
        <td>Olivia</td>
        <td>LI</td>
        
        <td class="col-wtn">32.9</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4054757" target="_blank" rel="noopener noreferrer">4.94</a></td>
        <td class="col-national">310</td>
        <td>Palo Alto CA</td>
      </tr>
      <tr>
        <td class="col-rank">8</td>
        <td>Siya</td>
        <td>DALAL</td>
        
        <td class="col-wtn">33.31</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/2674845" target="_blank" rel="noopener noreferrer">4.26</a></td>
        <td class="col-national">1182</td>
        <td>Cupertino CA</td>
      </tr>
      <tr>
        <td class="col-rank">9</td>
        <td>Misha</td>
        <td>KATARIA</td>
        
        <td class="col-wtn">33.52</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4426031" target="_blank" rel="noopener noreferrer">4</a></td>
        <td class="col-national">1128</td>
        <td>Fremont CA</td>
      </tr>
      <tr>
        <td class="col-rank">10</td>
        <td>Summer</td>
        <td>STIRITZ</td>
        
        <td class="col-wtn">33.68</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3151147" target="_blank" rel="noopener noreferrer">4.72</a></td>
        <td class="col-national">382</td>
        <td>Ross CA</td>
      </tr>
      <tr>
        <td class="col-rank">11</td>
        <td>Paneez</td>
        <td>SHAHAB</td>
        
        <td class="col-wtn">33.76</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/5325217" target="_blank" rel="noopener noreferrer">3.98</a></td>
        <td class="col-national">615</td>
        <td>Los Gatos CA</td>
      </tr>
      <tr>
        <td class="col-rank">12</td>
        <td>Eileen</td>
        <td>LI</td>
        
        <td class="col-wtn">33.79</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3110205" target="_blank" rel="noopener noreferrer">4.23</a></td>
        <td class="col-national">559</td>
        <td>Sunnyvale CA</td>
      </tr>
      <tr class="highlight-player">
        <td class="col-rank">13</td>
        <td>Alexis</td>
        <td>MALAKHOVA</td>
        
        <td class="col-wtn">33.85</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3610257" target="_blank" rel="noopener noreferrer" title="Open UTR profile">4.02</a></td>
        <td class="col-national">818</td>
        <td>Mountain View CA</td>
      </tr>
      <tr>
        <td class="col-rank">14</td>
        <td>Damayanthi</td>
        <td>ARUNKUMAR</td>
        
        <td class="col-wtn">33.86</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3247327" target="_blank" rel="noopener noreferrer">4.00</a></td>
        <td class="col-national">457</td>
        <td>Fremont CA</td>
      </tr>
      <tr>
        <td class="col-rank">15</td>
        <td>Noor</td>
        <td>DESAI</td>
        
        <td class="col-wtn">33.93</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3728581" target="_blank" rel="noopener noreferrer">4.36</a></td>
        <td class="col-national">463</td>
        <td>San Francisco CA</td>
      </tr>
      <tr>
        <td class="col-rank">16</td>
        <td>Ruoyu</td>
        <td>SUN</td>
        
        <td class="col-wtn">33.97</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4324163" target="_blank" rel="noopener noreferrer">3.99</a></td>
        <td class="col-national">1028</td>
        <td>San Jose CA</td>
      </tr>
      <tr>
        <td class="col-rank">17</td>
        <td>Megan</td>
        <td>LAI</td>
        
        <td class="col-wtn">34.03</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/5078823" target="_blank" rel="noopener noreferrer">3.58</a></td>
        <td class="col-national">1016</td>
        <td>San Ramon CA</td>
      </tr>
      <tr>
        <td class="col-rank">18</td>
        <td>Annabel</td>
        <td>HU</td>
        
        <td class="col-wtn">34.21</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3095546" target="_blank" rel="noopener noreferrer">4.3</a></td>
        <td class="col-national">562</td>
        <td>Palo Alto CA</td>
      </tr>
      <tr>
        <td class="col-rank">19</td>
        <td>Stephanie</td>
        <td>LI</td>
        
        <td class="col-wtn">34.25</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4315954" target="_blank" rel="noopener noreferrer">3.68</a></td>
        <td class="col-national">1926</td>
        <td>Cupertino CA</td>
      </tr>
      <tr>
        <td class="col-rank">20</td>
        <td>Jenna</td>
        <td>YU</td>
        
        <td class="col-wtn">34.42</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3432127" target="_blank" rel="noopener noreferrer">3.85</a></td>
        <td class="col-national">451</td>
        <td>Foster City CA</td>
      </tr>
      <tr>
        <td class="col-rank">21</td>
        <td>Kateryna</td>
        <td>MOLOCHKO</td>
        
        <td class="col-wtn">34.44</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4427419" target="_blank" rel="noopener noreferrer">3.68</a></td>
        <td class="col-national">610</td>
        <td>Castro Valley CA</td>
      </tr>
      <tr>
        <td class="col-rank">22</td>
        <td>Elise</td>
        <td>WATT</td>
        
        <td class="col-wtn">34.48</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4209273" target="_blank" rel="noopener noreferrer">3.47</a></td>
        <td class="col-national">1043</td>
        <td>Hillsborough CA</td>
      </tr>
      <tr>
        <td class="col-rank">23</td>
        <td>Bella</td>
        <td>WU</td>
        
        <td class="col-wtn">34.68</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3504317" target="_blank" rel="noopener noreferrer">3.68</a></td>
        <td class="col-national">751</td>
        <td>Los Gatos CA</td>
      </tr>
      <tr>
        <td class="col-rank">24</td>
        <td>Avaline</td>
        <td>WANG</td>
        
        <td class="col-wtn">34.86</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3987069" target="_blank" rel="noopener noreferrer">3.6</a></td>
        <td class="col-national">975</td>
        <td>Saratoga CA</td>
      </tr>
      <tr>
        <td class="col-rank">25</td>
        <td>Aashna</td>
        <td>MODI</td>
        
        <td class="col-wtn">35.01</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3173877" target="_blank" rel="noopener noreferrer">3.15</a></td>
        <td class="col-national">1509</td>
        <td>San Jose CA</td>
      </tr>
      <tr>
        <td class="col-rank">26</td>
        <td>Ellie</td>
        <td>WANG</td>
        
        <td class="col-wtn">35.09</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/5327345" target="_blank" rel="noopener noreferrer">3.06</a></td>
        <td class="col-national">1319</td>
        <td>Palo Alto CA</td>
      </tr>
      <tr>
        <td class="col-rank">27</td>
        <td>Amy</td>
        <td>LI</td>
        
        <td class="col-wtn">35.1</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4747020" target="_blank" rel="noopener noreferrer">3.36</a></td>
        <td class="col-national">899</td>
        <td>Saratoga CA</td>
      </tr>
      <tr>
        <td class="col-rank">28</td>
        <td>Emma</td>
        <td>LI</td>
        
        <td class="col-wtn">35.23</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/5524070" target="_blank" rel="noopener noreferrer">3.48</a></td>
        <td class="col-national">736</td>
        <td>Pleasanton CA</td>
      </tr>
      <tr>
        <td class="col-rank">29</td>
        <td>MAY</td>
        <td>SUN</td>
        
        <td class="col-wtn">35.35</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3860946" target="_blank" rel="noopener noreferrer">3.29</a></td>
        <td class="col-national">1130</td>
        <td>Sunnyvale CA</td>
      </tr>
      <tr>
        <td class="col-rank">30</td>
        <td>Zaira</td>
        <td>GADGIL</td>
        
        <td class="col-wtn">35.4</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3729362" target="_blank" rel="noopener noreferrer">3.17</a></td>
        <td class="col-national">750</td>
        <td>San Mateo CA</td>
      </tr>
      <tr>
        <td class="col-rank">31</td>
        <td>Akshaya</td>
        <td>ASHOK</td>
        
        <td class="col-wtn">35.41</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3505558" target="_blank" rel="noopener noreferrer">3.53</a></td>
        <td class="col-national">1251</td>
        <td>Milpitas CA</td>
      </tr>
      <tr>
        <td class="col-rank">32</td>
        <td>Sania</td>
        <td>BHAMBANI</td>
        
        <td class="col-wtn">35.72</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/3114224" target="_blank" rel="noopener noreferrer">3.14</a></td>
        <td class="col-national">1456</td>
        <td>Saratoga CA</td>
      </tr>
      <tr>
        <td class="col-rank">33</td>
        <td>Eliana</td>
        <td>MOGLEN</td>
        
        <td class="col-wtn">36.06</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4845382" target="_blank" rel="noopener noreferrer">3.06</a></td>
        <td class="col-national">1065</td>
        <td>Mill Valley CA</td>
      </tr>
      <tr>
        <td class="col-rank">34</td>
        <td>Olivia</td>
        <td>WANG</td>
        
        <td class="col-wtn">36.13</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4400838" target="_blank" rel="noopener noreferrer">2.74</a></td>
        <td class="col-national">1213</td>
        <td>Fremont CA</td>
      </tr>
      <tr>
        <td class="col-rank">35</td>
        <td>Liana</td>
        <td>CAI</td>
        
        <td class="col-wtn">36.32</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4513492" target="_blank" rel="noopener noreferrer">2.79</a></td>
        <td class="col-national">644</td>
        <td>San Jose CA</td>
      </tr>
      <tr>
        <td class="col-rank">36</td>
        <td>Cassia</td>
        <td>GARCIA</td>
        
        <td class="col-wtn">36.72</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/5385839" target="_blank" rel="noopener noreferrer">2.27</a></td>
        <td class="col-national">1653</td>
        <td>Pacifica CA</td>
      </tr>
      <tr>
        <td class="col-rank">37</td>
        <td>Sanaia</td>
        <td>GOUDIE</td>
        
        <td class="col-wtn">36.84</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/2816542" target="_blank" rel="noopener noreferrer">3.05</a></td>
        <td class="col-national">1133</td>
        <td>Oakley CA</td>
      </tr>
      <tr>
        <td class="col-rank">38</td>
        <td>Katherine</td>
        <td>CAO</td>
        
        <td class="col-wtn">36.92</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/5096309" target="_blank" rel="noopener noreferrer">2.27</a></td>
        <td class="col-national">2091</td>
        <td>Los Altos CA</td>
      </tr>
      <tr>
        <td class="col-rank">39</td>
        <td>Sarahana</td>
        <td>CHITAURE</td>
        
        <td class="col-wtn">38.89</td>
        <td class="col-utr"><a href="https://app.utrsports.net/profiles/4449589" target="_blank" rel="noopener noreferrer">2.1</a></td>
        <td class="col-national">1267</td>
        <td>El Sobrante CA</td>
      </tr>
    </tbody>
  </table>

  <div class="utr-histogram">
    <h3>UTR Distribution <span class="utr-subtitle">(0.5-point bins)</span></h3>
    <div id="utr-histogram-chart" class="utr-histogram-chart"></div>
    <div class="utr-histogram-caption" id="utr-histogram-caption">Based on UTR values from the player list.</div>
  </div>

  <div class="stats-section">
    <h3>Tournament Statistics</h3>
    <div class="stats-grid">
      <div class="stat-box">
        <div class="stat-label">Total Players</div>
        <div class="stat-value">39</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">WTN Range</div>
        <div class="stat-value">30.63 - 38.89</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Avg WTN</div>
        <div class="stat-value">34.26</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Avg UTR</div>
        <div class="stat-value">3.81</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Alexis Seed Position</div>
        <div class="stat-value">20 / 39</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Stronger Opponents (UTR)</div>
        <div class="stat-value">12 players</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">% Above Alexis (UTR)</div>
        <div class="stat-value">31%</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Top UTR</div>
        <div class="stat-value">5.95</div>
      </div>
    </div>
  </div>

  <div class="tournament-details-page">
    <h2>Tournament Information & Details</h2>

    <h3>Draw & Selection</h3>
    <div class="selection-callout">Selection uses the most recent National Standings List order for U12 events.</div>
    <div class="detail-row">
      <span class="detail-label">Draw Size:</span>
      <span class="detail-value">32 players (12s/14s combined)</span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Total Registered:</span>
      <span class="detail-value">39 players</span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Selection Process:</span>
      <span class="detail-value">By National Standings List order (U12 L4)</span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Seeding:</span>
      <span class="detail-value">Most recent National Standings List order (top 8 seeds)</span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Cutoff Line:</span>
      <span class="detail-value">Between National Standing ranks 32 and 33</span>
    </div>

    <h3>Format & Scoring</h3>
    <div class="detail-row">
      <span class="detail-label">Match Format:</span>
      <span class="detail-value">Best of 3 TB sets (6-game sets)</span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Set Tiebreak:</span>
      <span class="detail-value">7-point tiebreak at 6-6</span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Match Tiebreak:</span>
      <span class="detail-value">10-point match tiebreak in lieu of 3rd set</span>
    </div>

    <h3>Venue Information</h3>
    <div class="detail-row">
      <span class="detail-label">Site 1:</span>
      <span class="detail-value"><a href="https://www.google.com/maps/search/?api=1&query=Willow+Glen+Middle+School+San+Jose+CA" target="_blank" style="color: #4472C4; text-decoration: none;">Willow Glen Middle School, 2001 Cottle Ave, San Jose, CA 95125</a></span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Site 2:</span>
      <span class="detail-value"><a href="https://www.google.com/maps/search/?api=1&query=Willow+Glen+High+School+San+Jose+CA" target="_blank" style="color: #4472C4; text-decoration: none;">Willow Glen High School, 2425 Lincoln Ave, San Jose, CA 95125</a></span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Site 3:</span>
      <span class="detail-value"><a href="https://www.google.com/maps/search/?api=1&query=Piedmont+Hills+High+School+San+Jose+CA" target="_blank" style="color: #4472C4; text-decoration: none;">Piedmont Hills High School, 1377 Piedmont Rd, San Jose, CA 95132</a></span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Tournament Dates:</span>
      <span class="detail-value">January 10-18, 2026</span>
    </div>

    <h3>Tournament Contact</h3>
    <div class="detail-row">
      <span class="detail-label">Tournament Director:</span>
      <span class="detail-value">Lyn Pasqua</span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Email:</span>
      <span class="detail-value"><a href="mailto:craig@fourdirectionstennis.net">craig@fourdirectionstennis.net</a></span>
    </div>
    <div class="detail-row">
      <span class="detail-label">Phone:</span>
      <span class="detail-value"><a href="tel:+14085907347">(408) 590-7347</a></span>
    </div>

    <div class="important-note">
      <strong>Note:</strong> Alexis MALAKHOVA is ranked 20/39 by National Standing, placing comfortably within the 32-player draw with a 12-player cushion above the cutoff. She will NOT be seeded (seeding limited to top 8).
    </div>
  </div>

  <script>
    // Player profile links keyed by "FIRST|LAST" (uppercase)
    const playerProfileUrlByName = {
      "AASHNA|MODI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018563728",
      "AKSHAYA|ASHOK": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018948492",
      "ALEXIS|MALAKHOVA": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018710796",
      "ALEXI|LABRECQUE": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018998280",
      "AMY|LI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019389340",
      "ANNABEL|HU": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018637000",
      "AVALINE|WANG": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019122088",
      "BELLA|WU": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018791290",
      "CAMILLE|KUNKEL": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018867069",
      "CASSIA|GARCIA": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019177416",
      "DAMAYANTHI|ARUNKUMAR": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018637289",
      "EILEEN|LI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018605732",
      "ELIANA|MOGLEN": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018969157",
      "ELISE|WATT": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019258117",
      "ELLIE|WANG": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019241036",
      "EMMA|LI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018930736",
      "HARPER|WANG": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018622907",
      "JENNA|YU": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018832337",
      "KATERYNA|MOLOCHKO": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019450380",
      "KATHERINE|CAO": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019303547",
      "LIANA|CAI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019456865",
      "MARGARET|DORAN": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019941530",
      "MAY|SUN": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018905027",
      "MEGAN|LAI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019656678",
      "MISHA|KATARIA": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019420835",
      "NOOR|DESAI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018653862",
      "OLIVIA|LI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018636218",
      "OLIVIA|WANG": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019404801",
      "PANEEZ|SHAHAB": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018690020",
      "RUOYU|SUN": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018989144",
      "SANAIA|GOUDIE": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018414359",
      "SANIA|BHAMBANI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018668291",
      "SARAHANA|CHITAURE": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019291144",
      "SIYA|DALAL": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018529839",
      "STEPHANIE|LI": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018832557",
      "SUMMER|STIRITZ": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018746621",
      "ZAIRA|GADGIL": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018667343",
      "ZHIYAN|DUAN": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2019107218",
      "ZIVA|GADGIL": "https://www.usta.com/en/home/play/player-search/profile.html#?uaid=2018658341",
    };

    function decorateMetricCellWithProfileLink(cell, url) {
      if (!cell || !url) return;
      if (cell.querySelector('a')) return;
      const text = cell.textContent.trim();
      const a = document.createElement('a');
      a.href = url;
      a.target = '_blank';
      a.rel = 'noopener noreferrer';
      a.textContent = text;
      a.title = 'Open player profile';
      cell.textContent = '';
      cell.appendChild(a);
    }

    function decoratePlayerLinks() {
      const tbody = document.querySelector('tbody');
      if (!tbody) return;
      const rows = Array.from(tbody.querySelectorAll('tr'));
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length < 7) return;
        const first = cells[1].textContent.trim().toUpperCase();
        const last = cells[2].textContent.trim().toUpperCase();
        const key = `${first}|${last}`;
        const url = playerProfileUrlByName[key];
        if (!url) return;
        // WTN (col 3) and Nat Rank (col 5)
        decorateMetricCellWithProfileLink(cells[3], url);
        decorateMetricCellWithProfileLink(cells[5], url);
      });
    }

    function toTitleCase(value) {
      return value
        .toLowerCase()
        .replace(/\b\w/g, letter => letter.toUpperCase());
    }

    function normalizeLastNames() {
      const tbody = document.querySelector('tbody');
      if (!tbody) return;
      const rows = Array.from(tbody.querySelectorAll('tr'));
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length < 3) return;
        const lastCell = cells[2];
        const text = lastCell.textContent.trim();
        if (!text) return;
        lastCell.textContent = toTitleCase(text);
      });
    }

    function normalizeLocations() {
      const tbody = document.querySelector('tbody');
      if (!tbody) return;
      const rows = Array.from(tbody.querySelectorAll('tr'));
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length < 7) return;
        const locationCell = cells[6];
        const text = locationCell.textContent.trim();
        if (!text) return;
        if (text.includes(',')) return;
        const parts = text.split(/\s+/);
        if (parts.length < 2) return;
        const state = parts.pop();
        const city = parts.join(' ');
        locationCell.textContent = `${city}, ${state}`;
      });
    }

    function formatUtrRangeLabel(start, binSize) {
      const end = start + binSize - 0.01;
      return `${start.toFixed(1)}-${end.toFixed(2)}`;
    }

    function getDrawSizeFromKeyStats() {
      const stats = Array.from(document.querySelectorAll('.key-stat'));
      for (const stat of stats) {
        const label = stat.querySelector('.key-label');
        const value = stat.querySelector('.key-value');
        if (!label || !value) continue;
        if (label.textContent.trim().toLowerCase() === 'draw') {
          const size = parseInt(value.textContent.trim(), 10);
          if (Number.isFinite(size)) return size;
        }
      }
      return null;
    }

    function buildUtrHistogram() {
      const container = document.getElementById('utr-histogram-chart');
      if (!container) return;
      const rows = Array.from(document.querySelectorAll('tbody tr'));
      if (!rows.length) return;

      const players = rows.map(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length < 6) return null;
        const utr = parseFloat(cells[4].textContent.trim());
        const natRank = parseInt(cells[5].textContent.trim(), 10);
        if (!Number.isFinite(natRank)) return null;
        return {
          utr: Number.isFinite(utr) ? utr : null,
          natRank,
          highlight: row.classList.contains('highlight-player'),
        };
      }).filter(Boolean);

      if (!players.length) return;

      players.sort((a, b) => a.natRank - b.natRank);
      const drawSize = getDrawSizeFromKeyStats() || players.length;
      const drawPlayers = players.slice(0, drawSize);
      const values = drawPlayers
        .map(player => player.utr)
        .filter(value => Number.isFinite(value));

      if (!values.length) return;

      const highlightPlayer = drawPlayers.find(
        player => player.highlight && Number.isFinite(player.utr)
      );
      const highlightUtr = highlightPlayer ? highlightPlayer.utr : null;

      const binSize = 0.5;
      const min = Math.min(...values);
      const max = Math.max(...values);
      const startBin = Math.floor(min / binSize) * binSize;
      const endBin = Math.floor(max / binSize) * binSize;
      const binCount = Math.round((endBin - startBin) / binSize) + 1;
      const bins = new Array(binCount).fill(0);

      values.forEach(value => {
        const idx = Math.floor((value - startBin) / binSize);
        if (idx >= 0 && idx < bins.length) {
          bins[idx] += 1;
        }
      });

      const maxCount = Math.max(...bins, 1);
      container.innerHTML = '';

      const highlightIndex =
        highlightUtr !== null ? Math.floor((highlightUtr - startBin) / binSize) : null;

      bins.forEach((count, index) => {
        if (count === 0) return;
        const start = startBin + index * binSize;
        const row = document.createElement('div');
        row.className = 'utr-bin';

        if (highlightIndex !== null && highlightIndex === index) {
          row.classList.add('is-highlight');
        }

        const label = document.createElement('div');
        label.className = 'utr-bin-label';
        label.textContent = formatUtrRangeLabel(start, binSize);

        const barWrap = document.createElement('div');
        barWrap.className = 'utr-bin-bar-wrap';

        const bar = document.createElement('div');
        bar.className = 'utr-bin-bar';
        bar.style.width = `${(count / maxCount) * 100}%`;
        barWrap.appendChild(bar);

        const countEl = document.createElement('div');
        countEl.className = 'utr-bin-count';
        countEl.textContent = String(count);

        row.appendChild(label);
        row.appendChild(barWrap);
        row.appendChild(countEl);

        container.appendChild(row);
      });

      const captionEl = document.getElementById('utr-histogram-caption');
      if (captionEl) {
        let caption = `Based on ${values.length} of ${drawPlayers.length} draw players with UTR ratings.`;
        if (highlightUtr !== null) {
          caption += ' Alexis bin highlighted.';
        }
        captionEl.textContent = caption;
      }
    }

    // Update row numbers dynamically
    function updateRowNumbers() {
      const tbody = document.querySelector('tbody');
      const rows = tbody.querySelectorAll('tr');
      rows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
      });
    }

    // Add click-to-sort functionality
    const headers = document.querySelectorAll('th');
    const tbody = document.querySelector('tbody');
    const sortableColumns = new Set([1, 2, 3, 4, 5, 6]);
    const numericColumns = new Set([3, 4, 5]);
    const sortableHeaders = Array.from(headers).filter((header, columnIndex) =>
      sortableColumns.has(columnIndex)
    );

    sortableHeaders.forEach(header => {
      if (!header.dataset.sort) header.dataset.sort = 'none';
      if (!header.title) header.title = 'Click to sort';
    });

    function applySort(columnIndex, direction, activeHeader, updateHeaderStyle) {
      const rows = Array.from(tbody.querySelectorAll('tr'));

      rows.sort((a, b) => {
        const aText = a.cells[columnIndex].textContent.trim();
        const bText = b.cells[columnIndex].textContent.trim();
        const isNumeric = numericColumns.has(columnIndex);
        if (isNumeric) {
          const aVal = parseFloat(aText);
          const bVal = parseFloat(bText);
          if (Number.isNaN(aVal) && Number.isNaN(bVal)) return 0;
          if (Number.isNaN(aVal)) return 1;
          if (Number.isNaN(bVal)) return -1;
          return direction === 'asc' ? aVal - bVal : bVal - aVal;
        }
        const cmp = aText.localeCompare(bText, undefined, { sensitivity: 'base' });
        return direction === 'asc' ? cmp : -cmp;
      });

      tbody.innerHTML = '';
      rows.forEach(row => tbody.appendChild(row));
      updateRowNumbers();

      if (updateHeaderStyle) {
        headers.forEach(h => h.style.backgroundColor = '#4472C4');
        if (activeHeader) activeHeader.style.backgroundColor = '#2c5aa0';
      }
    }

    const defaultHeader = sortableHeaders.find(header => header.classList.contains('col-national'));
    if (defaultHeader) {
      sortableHeaders.forEach(h => {
        if (h !== defaultHeader) h.dataset.sort = 'none';
      });
      defaultHeader.dataset.sort = 'asc';
      applySort(5, 'asc', defaultHeader, true);
    }

    headers.forEach((header, columnIndex) => {
      // Only enable sorting for First/Last, WTN, UTR, Nat Rank, Location
      if (sortableColumns.has(columnIndex)) {
        header.addEventListener('click', () => {
          // Toggle sort direction
          const currentSort = header.dataset.sort || 'none';
          const newSort = currentSort === 'asc' ? 'desc' : 'asc';
          sortableHeaders.forEach(h => {
            if (h !== header) h.dataset.sort = 'none';
          });
          header.dataset.sort = newSort;
          applySort(columnIndex, newSort, header, true);
        });
      }
    });

    // Initialize row numbers on page load
    if (!defaultHeader) updateRowNumbers();
    decoratePlayerLinks();
    normalizeLastNames();
    normalizeLocations();
    buildUtrHistogram();

    // Share button functionality
    const shareButton = document.createElement('button');
    shareButton.className = 'share-button';
    shareButton.innerHTML = '↗';
    shareButton.title = 'Share this report';
    shareButton.setAttribute('aria-label', 'Share tournament report');

    shareButton.addEventListener('click', async () => {
      if (navigator.share) {
        try {
          await navigator.share({
            title: 'L4 Closed - U12 Girls Singles',
            text: 'Tournament Report - January 10-18, 2026',
            url: window.location.href
          });
        } catch (err) {
          if (err.name !== 'AbortError') {
            console.error('Share failed:', err);
          }
        }
      } else {
        // Fallback: Copy link to clipboard
        navigator.clipboard.writeText(window.location.href).then(() => {
          shareButton.innerHTML = '✓';
          setTimeout(() => {
            shareButton.innerHTML = '↗';
          }, 2000);
        });
      }
    });

    document.body.appendChild(shareButton);
  </script>
</body>
</html>
